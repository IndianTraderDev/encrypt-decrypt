<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Secure Encrypt/Decrypt</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0d6efd">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
  <!-- Add futuristic Google Fonts and custom CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
      color: #e0eafc;
      font-family: 'Orbitron', 'Roboto Mono', monospace;
      min-height: 100vh;
      /* Add subtle animated background effect */
      background-size: 400% 400%;
      animation: gradientMove 18s ease infinite;
    }
    @keyframes gradientMove {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }
    .container {
      max-width: 800px;
      background: rgba(20, 30, 50, 0.92);
      border-radius: 24px;
      box-shadow: 0 12px 48px 0 rgba(31, 38, 135, 0.37);
      padding: 3.5rem 3rem;
      margin-top: 4rem;
      border: 1px solid rgba(255,255,255,0.12);
      /* Add glassmorphism effect */
      backdrop-filter: blur(8px);
    }
    h2 {
      font-family: 'Orbitron', sans-serif;
      font-weight: 700;
      letter-spacing: 3px;
      text-align: center;
      margin-bottom: 2.5rem;
      color: #00fff7;
      text-shadow: 0 0 16px #00fff7, 0 0 4px #fff;
      font-size: 2.5rem;
    }
    label {
      font-weight: 500;
      color: #aeefff;
      letter-spacing: 1px;
      font-size: 1.1rem;
    }
    .form-control, textarea {
      background: rgba(44, 83, 100, 0.8);
      border: 1px solid #00fff7;
      color: #e0eafc;
      font-family: 'Roboto Mono', monospace;
      font-size: 1.1rem;
      border-radius: 12px;
      transition: box-shadow 0.2s, border-color 0.2s;
      margin-bottom: 1.5rem;
      padding: 0.75rem 1rem;
    }
    .form-control:focus, textarea:focus {
      box-shadow: 0 0 0 3px #00fff7;
      border-color: #00fff7;
      background: rgba(44, 83, 100, 0.95);
      color: #fff;
    }
    .form-check-input {
      accent-color: #00fff7;
      box-shadow: 0 0 6px #00fff7;
      width: 1.3em;
      height: 1.3em;
      margin-top: 0.2em;
    }
    .form-check-label {
      color: #e0eafc;
      font-family: 'Orbitron', sans-serif;
      font-size: 1.1rem;
      margin-left: 8px;
      letter-spacing: 1px;
    }
    .action-row {
      display: flex;
      gap: 2.5rem;
      justify-content: center;
      margin-bottom: 2rem;
    }
    .btn-primary, .btn-success {
      font-family: 'Orbitron', sans-serif;
      font-weight: 700;
      letter-spacing: 1px;
      border-radius: 12px;
      box-shadow: 0 2px 12px #00fff744;
      border: none;
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
      font-size: 1.15rem;
      padding: 0.75rem 2.5rem;
    }
    .btn-primary {
      background: linear-gradient(90deg, #00fff7 0%, #007cf0 100%);
      color: #1a1a2e;
    }
    .btn-primary:hover {
      background: linear-gradient(90deg, #007cf0 0%, #00fff7 100%);
      color: #fff;
      box-shadow: 0 6px 24px #00fff7aa;
      transform: translateY(-2px) scale(1.04);
    }
    .btn-success {
      background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%);
      color: #1a1a2e;
    }
    .btn-success:hover {
      background: linear-gradient(90deg, #38f9d7 0%, #43e97b 100%);
      color: #fff;
      box-shadow: 0 6px 24px #43e97baa;
      transform: translateY(-2px) scale(1.04);
    }
    #result {
      background: rgba(44, 83, 100, 0.85);
      border: 1px solid #00fff7;
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1.5rem;
      min-height: 80px;
      color: #fff;
      font-family: 'Roboto Mono', monospace;
      font-size: 1.15rem;
      word-break: break-word;
      white-space: pre-wrap;
      box-shadow: 0 4px 18px #00fff744;
      transition: box-shadow 0.2s;
    }
    #result:empty {
      min-height: 80px;
      background: rgba(44, 83, 100, 0.5);
      border: 1px dashed #00fff7;
    }
    .section-title {
      color: #00fff7;
      text-shadow: 0 0 8px #00fff7;
      font-family: 'Orbitron', sans-serif;
      font-size: 1.3rem;
      margin-top: 2rem;
      margin-bottom: 0.5rem;
      letter-spacing: 1px;
    }
    @media (max-width: 900px) {
      .container {
        max-width: 98vw;
        padding: 2rem 0.5rem;
      }
      h2 {
        font-size: 2rem;
      }
      .btn-primary, .btn-success {
        padding: 0.75rem 1rem;
        font-size: 1rem;
      }
      .action-row {
        gap: 1rem;
      }
    }
    @media (max-width: 600px) {
      .container {
        padding: 1rem 0.5rem;
      }
      h2 {
        font-size: 1.5rem;
      }
      .btn-primary, .btn-success {
        padding: 0.5rem 0.5rem;
        font-size: 0.95rem;
      }
      .action-row {
        flex-direction: column;
        gap: 0.5rem;
      }
    }
  </style>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').then(function(registration) {
        console.log('ServiceWorker registration successful:', registration.scope);
      }, function(error) {
        console.error('ServiceWorker registration failed:', error);
      });
    }
  </script>
</head>
<body>
  <div class="container">
    <h2>Secure Encrypt/Decrypt</h2>
    <div class="row">
      <div class="col-md-6 mb-4">
        <label for="password" class="section-title">Password</label>
        <input class="form-control" id="password" type="password" autocomplete="off" placeholder="Enter your password">
      </div>
      <div class="col-md-6 mb-4">
        <label for="text" class="section-title">Text</label>
        <textarea class="form-control" id="text" rows="8" placeholder="Enter text to encrypt or decrypt"></textarea>
      </div>
    </div>
    <div class="action-row mb-3">
      <div class="form-check">
        <input class="form-check-input" type="radio" name="option" id="optionEncrypt">
        <label class="form-check-label" for="optionEncrypt">Encrypt</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="option" id="optionDecrypt">
        <label class="form-check-label" for="optionDecrypt">Decrypt</label>
      </div>
      <button id="go" class="btn btn-primary">Process</button>
      <button onclick="copy()" class="btn btn-success">Copy</button>
    </div>
    <div class="section-title">Result</div>
    <div id="result"></div>
  </div>

  <script>
    const textEl = document.getElementById("text");
    const passEl = document.getElementById("password");
    const resultEl = document.getElementById("result");

    async function getKey(password, salt) {
      const encoder = new TextEncoder();
      const keyMaterial = await crypto.subtle.importKey(
        "raw", encoder.encode(password), { name: "PBKDF2" }, false, ["deriveKey"]
      );
      return crypto.subtle.deriveKey(
        {
          name: "PBKDF2",
          salt: salt,
          iterations: 250000,
          hash: "SHA-256"
        },
        keyMaterial,
        { name: "AES-GCM", length: 256 },
        false,
        ["encrypt", "decrypt"]
      );
    }

    async function encrypt(text, password) {
      const encoder = new TextEncoder();
      const salt = crypto.getRandomValues(new Uint8Array(16));
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const key = await getKey(password, salt);
      const ciphertext = await crypto.subtle.encrypt({ name: "AES-GCM", iv: iv }, key, encoder.encode(text));
      const combined = new Uint8Array(salt.byteLength + iv.byteLength + ciphertext.byteLength);
      combined.set(salt);
      combined.set(iv, salt.byteLength);
      combined.set(new Uint8Array(ciphertext), salt.byteLength + iv.byteLength);
      return btoa(String.fromCharCode(...combined));
    }

    async function decrypt(encoded, password) {
      try {
        const data = Uint8Array.from(atob(encoded), c => c.charCodeAt(0));
        const salt = data.slice(0, 16);
        const iv = data.slice(16, 28);
        const ciphertext = data.slice(28);
        const key = await getKey(password, salt);
        const decrypted = await crypto.subtle.decrypt({ name: "AES-GCM", iv: iv }, key, ciphertext);
        return new TextDecoder().decode(decrypted);
      } catch (e) {
        return "❌ Decryption failed. Incorrect password or corrupted data.";
      }
    }

    document.getElementById("go").onclick = async () => {
      const password = passEl.value;
      const text = textEl.value;
      const option = document.querySelector('input[name="option"]:checked');

      if (!password || !option) {
        resultEl.innerText = "⚠️ Please provide both password and action.";
        return;
      }

      if (option.id === "optionEncrypt") {
        const encrypted = await encrypt(text, password);
        resultEl.innerText = encrypted;
      } else {
        const decrypted = await decrypt(text, password);
        resultEl.innerText = decrypted;
      }
    };

    function copy() {
      navigator.clipboard.writeText(resultEl.innerText).then(() => {
        alert("Copied!");
      }, () => {
        alert("Failed to copy.");
      });
    }
  </script>
</body>
<!-- End of file
